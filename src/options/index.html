<html>
  <head>
    <title i18n="optionstitle"></title>
    <link rel="stylesheet" href="options.css" />
    <link rel="stylesheet" href="../jquery/css/custom-theme/jquery-ui-1.8.custom.css" />
    <script src="../jquery/jquery.min.js"></script>
    <script src="../port.js"></script>
    <script src="../jquery/jquery.cookie.js"></script>
    <script src="../jquery/jquery-ui.custom.min.js"></script>
    <script src="../functions.js"></script>
    <script>
      function load_options() {
        // Check or uncheck each option.
        BGcall("get_settings", function(settings) {
          optionalSettings = settings;
          $("#tabpages").
            tabs({ 
              spinner: "",
              cache: true,
              cookie: {},
              load: function() {
                //translation
                localizePage();

                $(".advanced").toggle(optionalSettings.show_advanced_options);
                $(".chrome-only").toggle(!SAFARI);
              },
            }).
            show();
        });
      }
      var optionalSettings = {};
      load_options();

      function displayVersionNumber() {
        try {
          var xhr = new XMLHttpRequest();
          xhr.open("GET", chrome.extension.getURL('manifest.json'), true);
          xhr.onreadystatechange = function() {
            if(this.readyState == 4) {
              var theManifest = JSON.parse(this.responseText);
              $("#version_number").text(translate("optionsversion", [theManifest.version]));
            }
          };
          xhr.send();
        } catch (ex) {} // silently fail
      }

      $(function() {
        displayVersionNumber();

        if (navigator.language.substring(0, 2) != "en")
          $("#translation_credits").text(translate("translator_credit"));

        //translation
        localizePage();
      });
    </script>
  </head>
  <body>
    <div style="float:right;"> 
      <div>
        <span id="version_number"></span>
        (<a href="http://code.google.com/p/adblockforchrome/wiki/Changelog" target="_blank" i18n="optionschangelog"></a>) 
      </div>
      <div>
        <a href="http://code.google.com/p/adblockforchrome" target="_blank" i18n="project_home"></a> |
        <a href="http://code.google.com/p/adblockforchrome/wiki/GetHelp?tm=3" target="_blank" i18n="help"></a> |
        <a href="http://code.google.com/p/adblockforchrome/wiki/FrequentlyAskedQuestions" target="_blank" i18n="faq"></a>
      </div>
      <div id="translation_credits"></div>
    </div>
    <h1 class="icon" i18n="optionstitle"></h1>

    <div class="noticecontainer">
      <div class="notice" id="safari50_updatenotice" i18n="safari50_updatenotice" i18n_replacement_el="safari50_update_link"></div>
      <a id="safari50_update_link" href="http://www.apple.com/safari/" target="_blank"></a>
    </div>

    <div style="margin: 1em 0px; font-size: 16px">
      <div class="link" id="paymentlink" i18n="did_you_know_this_is_my_full_time_job"></div>
      <script>
        $(function() {
          if (SAFARI && LEGACY_SAFARI) {
            $("#safari50_updatenotice").show();
          }

          $('#paymentlink').click(function() {
            BGcall("storage_get", "userid", function(userId) {
              var href = "http://chromeadblock.com/pay/?source=O&u=" + userId;
              if (SAFARI) {
                // Safari target=_blank opens a new window by default, so we have to force its
                // height to be correct.
                window.open(href, "payment", 'location=0,status=0,scrollbars=0,width=800,height=550');
              } else {
                BGcall("openTab", href);
              }
            });
            return false;
          });
        });
      </script>
    </div>

    <div id="tabpages">
      <ul>
        <li><a href="general.html"><span i18n="tabgeneral"></span></a></li>
        <li><a href="filters.html"><span i18n="tabfilterlists"></span></a></li>
        <li><a href="customize.html"><span i18n="tabcustomize"></span></a></li>
      </ul>
    </div>
  </body>
</html>
